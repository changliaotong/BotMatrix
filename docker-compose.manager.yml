version: '3.8'

networks:
  default:
    external:
      name: botmatrix_net

services:
  # 1. BotNexus: High-performance WebSocket Gateway & Proxy
  bot-nexus:
    build: 
      context: ./src/BotNexus
    container_name: btnexus
    restart: always
    ports:
      - "${WS_PORT:-3002}:3001"  # WebSocket Gateway
      - "${WEB_PORT:-5000}:5000"  # WebUI
    volumes:
      - ./src/BotNexus/data:/app/data
      - ./stats.json:/app/stats.json
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - TZ=Asia/Shanghai
      - REDIS_ADDR=${REDIS_ADDR:-192.168.0.126:6379}
      - REDIS_PWD=${REDIS_PWD:-redis_zsYik8}
