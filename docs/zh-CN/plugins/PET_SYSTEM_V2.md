# 宠物系统 (Pet System) V2.0.0 技术文档

## 1. 系统概述
宠物系统是一个深度集成的互动模块，允许用户领养、培养并与虚拟宠物进行多种互动。系统包含状态管理、经济循环、养成机制以及丰富的互动指令。

## 2. 核心机制

### 2.1 领养与成长
- **领养**: 每个用户可以领养一只宠物，宠物具有随机生成的个性和类型。
- **等级**: 宠物通过互动、打工和冒险获得经验值并升级。
- **属性**:
    - **体力 (Energy)**: 执行动作消耗体力，可通过休息回复。
    - **饱食度 (Hunger)**: 随时间增加，过高会影响心情和健康，需喂食。
    - **心情 (Happiness)**: 影响打工收益和互动效果。
    - **亲密度 (Intimacy)**: 衡量主人与宠物的关系。

### 2.2 状态管理
宠物在同一时间只能处于一种状态：
- `Idle` (空闲)
- `Working` (打工中)
- `Adventuring` (冒险中)
- `Resting` (休息中)

### 2.3 互动行为
- **喂食**: 使用背包中的道具降低饱食度并提升属性。
- **互动 (摸摸/玩耍)**: 提升亲密度和心情。
- **打工**: 获取金币，但消耗大量体力。
- **冒险**: 随机触发事件，可能获得道具、经验或金币。

## 3. 数据模型

### 3.1 Pet (宠物核心数据)
| 字段 | 类型 | 说明 |
| :--- | :--- | :--- |
| Id | Guid | 宠物唯一标识 (主键) |
| UserId | string | 所属用户 ID |
| Name | string | 宠物名称 |
| Type | Enum | 宠物种类 (猫、狗、狐狸等) |
| Personality | Enum | 个性 (平凡、精力充沛、懒散等) |
| Level | int | 当前等级 |
| Gold | int | 宠物持有的金币 |
| Health/Hunger/Energy | double | 核心状态数值 |

### 3.2 PetInventory (宠物背包)
存储宠物拥有的道具及其数量。

### 3.3 PetItem (道具定义)
| 属性 | 说明 |
| :--- | :--- |
| Name | 道具名称 |
| Price | 商店售价 |
| Effects | 对宠物属性的影响 (Hunger, Energy, Happiness 等) |

## 4. 指令接口

| 指令 | 说明 | 参数 |
| :--- | :--- | :--- |
| `领养宠物` | 开启你的养宠之旅 | [宠物名称] |
| `宠物状态` | 查看宠物的详细属性和当前心情 | - |
| `宠物喂食` | 给宠物喂食背包里的道具 | <道具名> |
| `宠物商店` | 浏览并购买宠物消耗品 | - |
| `宠物互动` | 增加亲密度和心情 | - |
| `宠物打工` | 让宠物赚取金币 | - |
| `宠物冒险` | 出发去探索未知领域 | - |
| `宠物休息` | 快速回复体力 | - |
| `宠物改名` | 为宠物起个新名字 | <新名称> |
| `宠物排行榜` | 查看等级或金币排行 | [等级/金币] |

## 5. 经济循环
1. **获取金币**: 通过 `打工` 和 `冒险` 获得。
2. **消耗金币**: 在 `商店` 购买食物和道具。
3. **转化收益**: 道具转化为宠物的 `属性` 和 `等级`，提升后续活动的成功率与收益。

## 6. 开发规范
- 模块位于 `BotWorker.Modules.Games` 命名空间。
- 采用 `MetaDataGuid<T>` 进行数据持久化。
- 使用 `PetCommand` 特性注册指令，确保与主框架的兼容性。
- 状态更新遵循 `LastUpdateTime` 增量计算逻辑，确保离线期间的状态平滑演变。
