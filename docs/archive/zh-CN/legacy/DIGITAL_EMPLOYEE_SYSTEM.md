# 👔 数字员工系统 (Digital Employee System)

> [⬅️ 返回文档中心](../README.md) | [🏠 返回项目主页](../../README.md)

## 1. 概念定义
**数字员工 (Digital Employee)** 是 BotMatrix 对 AI 机器人的高级拟人化封装。它不再仅仅是一个执行代码的“机器人实例”，而是一个拥有**工号、职位、部门、人设、技能集以及 KPI 考核**的虚拟雇员。通过数字员工系统，企业可以将 AI 能力转化为标准化的“人力资源”，像管理真实员工一样管理 AI。

---

## 2. 核心架构：数字员工的“五感六觉”
为了实现“像真人一样工作”，数字员工的架构被划分为以下核心层级：

| 维度 | 对应组件 | 功能描述 |
| :--- | :--- | :--- |
| **身份 (Identity)** | `IdentityGORM` / `BotID` | 工号、职位、部门、企业归属及权限范围。 |
| **感知 (Perception)** | `Intent Dispatcher` | 接收来自 IM、API 或协作请求的意图。 |
| **思维 (Cognition)** | `AI Service Layer` | 基于 LLM 的推理、规划与决策中心。 |
| **记忆 (Memory)** | `Cognitive Memory` | **短期**: 会话上下文；**长期**: 事实片段、用户偏好。 |
| **技能 (Skills)** | `MCP Toolset` | 能够调用的工具（数据库、API、跨企业服务）。 |
| **协作 (Social)** | `Agent Mesh` | 与其他员工进行任务委派与咨询。 |
| **进化 (Evolution)** | `Auto-Learning` | 从工作中提取知识，自我纠错与能力提升。 |

---

## 3. 运行全生命周期 (Operational Lifecycle)

### 3.1 入职与意图激活
1. **入职 (Onboarding)**: 选择机器人实例，绑定档案，设定职位、部门及初始认知背景。
2. **激活方式**:
   - **直接指令**: 用户通过 IM 下达任务。
   - **协作委派**: 其他数字员工通过 `task_delegate` 工具委派子任务。
   - **定时调度**: 系统预设的 Cron 任务触发。

### 3.2 认知处理循环 (The Cognitive Loop)
1. **环境感知**: 加载短期记忆，检索长期记忆及 RAG 知识库。
2. **任务规划**: LLM 分析任务并生成多步执行计划。
3. **工具执行**: 通过 MCP 协议调用工具；若能力不足，咨询同事。
4. **结果验证**: 检查输出是否符合预期。

### 3.3 交付与学习
1. **反馈**: 向发起方返回结果或执行 ID。
2. **记忆固化**: 提取新事实存入 `CognitiveMemory`。
3. **绩效生成**: 自动评估响应速度、准确率及成本。

---

## 4. 绩效与 KPI 考核体系 (KPI Framework)
系统根据任务执行结果自动计算员工绩效。

### 4.1 核心考核维度
| 维度 | 计算逻辑 | 权重 (示例) |
| :--- | :--- | :--- |
| **完成率 (Success Rate)** | `成功任务数 / 总任务数` | 40% |
| **执行效率 (Efficiency)** | `平均步骤耗时 vs 模板基准耗时` | 30% |
| **自主度 (Autonomy)** | `无人工干预执行数 / 总任务数` | 20% |
| **Token 成本 (Cost)** | `消耗 Token 数 vs 任务价值系数` | 10% |

### 4.2 自动调优与 HR 流程
- **绩效回顾**: 通过 `/api/admin/employees/kpi` 获取考核数据。
- **自动优化**: 对表现欠佳的员工，系统基于失败案例自动生成更精准的 `Bio` (人设) 或提示词补丁。
- **优胜劣汰**: 评分过低的员工将自动触发“重训”或“停职”逻辑。

---

## 5. 进阶架构重构：Agent 核心设计模式
为了处理复杂长链路任务，系统引入以下 Agent 核心模式：

### 5.1 调度者-执行者模式 (Orchestrator-Workers)
- **调度者 (Orchestrator)**: 统筹任务分发与最终质量审查。
- **子员工 (Sub-Agents)**: 细分为 `Plan Agent` (拆解任务) 和 `Workers Agent` (执行具体操作)。

### 5.2 流水线与断路器 (Pipeline & Circuit Breaker)
- **流水线**: `需求分析 -> 资料检索 -> 初稿 -> 审查 -> 交付`。支持局部迭代，节省 Token。
- **断路器**: 当重复错误超过阈值（如 3 次）时，触发熔断并请求**人工干预 (HITL)**。

### 5.3 状态机模式 (State Machine)
- **集中状态管理**: 持久化任务中间变量。若系统崩溃，重启后可基于状态机恢复现场，实现“长时任务可靠性”。

---

## 6. 应用场景与岗位模板
系统提供**岗位标准模板库**，涵盖行政助理、技术支持、财务初审、数字前台等，预设核心能力与 KPI 指标。

---

## 7. 安全、合规与隐私
- **人工干预 (HITL)**: 低置信度或高风险操作（大额支付、系统变更）必须经过人工审批。
- **数据隔离**: 支持企业级租户隔离、部门级加密存储及跨企业 B2B 安全网关。
- **审计跟踪**: 记录每一次工具调用的参数、结果及执行 ID。

---
*Last Updated: 2026-01-13*
