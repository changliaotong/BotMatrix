import { translateApi } from '../api/translate';

export type Language = 'zh-CN' | 'zh-TW' | 'en-US' | 'ja-JP';

export const translations: Record<Language, Record<string, string>> = {
  'zh-CN': {
    'dashboard': '运行状态',
    'bots': '人机矩阵',
    'nexus': '核心枢纽',
    'workers': '工作节点',
    'contacts': '人脉管理',
    'tasks': '任务管理',
    'fission': '裂变增长',
    'docker': '容器管理',
    'routing': '路由控制',
    'users': '用户权限',
    'manual': '使用手册',
    'logs': '日志中心',
    'settings': '系统设置',
    'main_menu': '主要功能',
    'automation_menu': '自动化',
    'infrastructure_menu': '基础设施',
    'system_menu': '系统管理',
    'workers_desc': '管理分布在各地的工作节点',
    'contacts_desc': '查看和管理所有机器人的好友与群聊',
    'nexus_desc': '监控核心连接与中继状态',
    'tasks_desc': '配置并监控各类自动化任务',
    'fission_desc': '管理社交裂变与增长任务',
    'docker_desc': '监控并管理 Docker 容器状态',
    'routing_desc': '定义全局消息路由规则',
    'users_desc': '管理系统访问权限与用户',
    'manual_desc': '查看用户手册与 API 文档',
    'coming_soon': '敬请期待',
    'feature_under_development': '该功能正在现代化升级中，即将上线。',
    'system_uptime': '系统运行时间',
    'current_time': '当前时间',
    'neural_link_active': '神经链接已建立',
    'switch_lang': '切换语言',
    'switch_theme': '切换主题',
    'logout': '退出登录',
    'refresh': '刷新',
    'clear': '清空',
    'save': '保存',
    'cancel': '取消',
    'status': '状态',
    'actions': '操作',
    'theme_light': '明亮模式',
    'theme_dark': '暗黑模式',
    'theme_matrix': '黑客帝国',
    'style_classic': '经典风格',
    'style_matrix': '矩阵风格',
    'style_xp': 'XP 经典',
    'style_ios': 'iOS 极简',
    'style_kawaii': '可爱风格',
    'mode_light': '日间模式',
    'mode_dark': '夜间模式',
    'lang_zh_cn': '简体中文',
    'lang_zh_tw': '繁体中文',
    'lang_en_us': 'English',
    'lang_ja_jp': '日本語',
    'ai_intelligence': '人工智能',
    'ai_config': 'AI 配置',
    'ai_provider': 'AI 供应商',
    'ai_model': '模型选择',
    'ai_translate_enabled': '开启实时 AI 翻译',
    'ai_analysis_enabled': '开启智能日志分析',
    'save_changes': '保存修改',
    'general': '常规设置',
    'security': '安全设置',
    'notifications': '通知推送',
    'language_region': '语言与地区',
    'mode_selection': '显示模式',
    'basic_config': '基础配置',
    'system_name': '系统名称',
    'interface_theme': '界面主题',
    'auto_scroll': '自动滚动',
    'log_level': '日志级别',
    'source': '来源',
    'message': '消息',
    'time': '时间',
    'no_logs': '暂无日志数据',
    'total_bots': '在线机器人',
    'active_bots': '活跃机器人',
    'total_messages': '今日消息',
    'system_load': '系统负载',
    'recent_logs': '最近日志',
    'view_all': '查看全部',
    'sidebar_dashboard': '运行状态',
    'sidebar_bots': '人机矩阵',
    'sidebar_monitor': '系统监控',
    'sidebar_docker': 'Docker管理',
    'sidebar_routing': '路由管理',
    'sidebar_logs': '日志中心',
    'sidebar_users': '用户管理',
    'sidebar_settings': '系统设置',
    'sidebar_visualization': '神经网络',
    'status_live': '实时',
    'status_loading': '加载中',
    'active_workers': '活动节点',
    'messages_today': '今日消息',
    'unit_nodes': '节点',
    'unit_active': '活动',
    'unit_msg': '消息',
    'unit_time': '实时',
    'cpu_usage': 'CPU 使用率',
    'memory_usage': '内存占用',
    'throughput': '消息吞吐',
    'active_groups': '活跃群组',
    'dragon_king': '今日龙王',
    'monitor_detail': '监控详情',
    'network_traffic': '网络流量',
    'process_monitor': '进程监控',
    'disk_status': '磁盘状态',
    'group_rank': '群聊排行',
    'speaker_rank': '发言排行',
    'bot_management': '机器人管理',
    'add_bot': '添加机器人',
    'bot_id': '机器人 ID',
    'view_logs': '查看日志',
    'delete': '删除',
    'start': '启动',
    'stop': '停止',
    'select_platform': '选择机器人平台',
    'configure_bot': '配置机器人',
    'confirm_add': '确认添加',
    'loading': '加载中...',
    'no_bots': '暂无机器人，点击右上角添加',
    'admin': '管理员',
    'user': '普通用户',
    'menu_group_main': '主要功能',
    'menu_group_system': '系统管理',
    'no_bots_desc': '您还没有部署任何机器人，点击右上角按钮开始您的第一个 Bot 部署。',
    'start_now': '立即开始',
    'messages': '消息数',
    'group_chats': '群聊',
    'friends': '好友',
    'currently_selected': '当前选中',
    'set_as_current': '设为当前',
    'deploy_new_bot': '部署新机器人',
    'select_and_configure': '选择平台并配置参数',
    'docker_image': 'Docker 镜像',
    'deploying': '正在部署...',
    'deploy_now': '立即部署',
    'realtime_logs': '实时运行日志',
    'syncing_live': '实时同步中...',
    'system_logs': '系统日志',
    'centralized_log_mgmt': '中心化日志管理系统',
    'auto_refresh_on': '自动刷新: 开启',
    'auto_refresh_off': '自动刷新: 关闭',
    'export': '导出',
    'search_logs': '搜索日志...',
    'all_sources': '所有来源',
    'all_levels': '所有级别',
    'entries_found': '条记录',
    'fetching_logs': '正在获取日志...',
    'system': '系统',
    'confirm_clear_logs': '确定要清空所有系统日志吗？'
  },
  'zh-TW': {
    'dashboard': '運行狀態',
    'bots': '人機矩陣',
    'nexus': '核心樞紐',
    'workers': '工作節點',
    'contacts': '人脈管理',
    'tasks': '任務管理',
    'fission': '裂變增長',
    'docker': '容器管理',
    'routing': '路由控制',
    'users': '用戶權限',
    'manual': '使用手冊',
    'logs': '日誌中心',
    'settings': '系統設置',
    'main_menu': '主要功能',
    'automation_menu': '自動化',
    'infrastructure_menu': '基礎設施',
    'system_menu': '系統管理',
    'workers_desc': '管理分佈在各地的工作節點',
    'contacts_desc': '查看和管理所有機器人的好友與群聊',
    'nexus_desc': '監控核心連接與中繼狀態',
    'tasks_desc': '配置並監控各類自動化任務',
    'fission_desc': '管理社交裂變與增長任務',
    'docker_desc': '監控並管理 Docker 容器狀態',
    'routing_desc': '定義全局消息路由規則',
    'users_desc': '管理系統訪問權限與用戶',
    'manual_desc': '查看用戶手冊與 API 文檔',
    'coming_soon': '敬請期待',
    'feature_under_development': '該功能正在現代化升級中，即將上線。',
    'system_uptime': '系統運行時間',
    'current_time': '當前時間',
    'neural_link_active': '神經鏈接已建立',
    'switch_lang': '切換語言',
    'switch_theme': '切換主題',
    'logout': '退出登錄',
    'refresh': '刷新',
    'clear': '清空',
    'save': '保存',
    'cancel': '取消',
    'status': '狀態',
    'actions': '操作',
    'theme_light': '明亮模式',
    'theme_dark': '暗黑模式',
    'theme_matrix': '黑客帝國',
    'style_classic': '經典風格',
    'style_matrix': '矩陣風格',
    'style_xp': 'XP 經典',
    'style_ios': 'iOS 極簡',
    'style_kawaii': '可愛風格',
    'lang_zh_cn': '简体中文',
    'lang_zh_tw': '繁體中文',
    'lang_en_us': 'English',
    'lang_ja_jp': '日本語',
    'auto_scroll': '自動滾動',
    'log_level': '日誌級別',
    'source': '來源',
    'message': '消息',
    'time': '時間',
    'no_logs': '暫無日誌數據',
    'total_bots': '在線機器人',
    'active_bots': '活躍機器人',
    'total_messages': '今日消息',
    'system_load': '系統負載',
    'recent_logs': '最近日誌',
    'view_all': '查看全部',
    'sidebar_dashboard': '運行狀態',
    'sidebar_bots': '人機矩陣',
    'sidebar_monitor': '系統監控',
    'sidebar_docker': 'Docker管理',
    'sidebar_routing': '路由管理',
    'sidebar_logs': '日誌中心',
    'sidebar_users': '用戶管理',
    'sidebar_settings': '系統設置',
    'sidebar_visualization': '神經網絡',
    'status_live': '實時',
    'status_loading': '加載中',
    'active_workers': '活動節點',
    'messages_today': '今日消息',
    'unit_nodes': '節點',
    'unit_active': '活動',
    'unit_msg': '消息',
    'unit_time': '實時',
    'cpu_usage': 'CPU 使用率',
    'memory_usage': '內存佔用',
    'throughput': '消息吞吐',
    'active_groups': '活躍群組',
    'dragon_king': '今日龍王',
    'monitor_detail': '監控詳情',
    'network_traffic': '網絡流量',
    'process_monitor': '進程監控',
    'disk_status': '磁盤狀態',
    'group_rank': '群聊排行',
    'speaker_rank': '發言排行',
    'bot_management': '機器人管理',
    'add_bot': '添加機器人',
    'bot_id': '機器人 ID',
    'view_logs': '查看日誌',
    'delete': '刪除',
    'start': '啟動',
    'stop': '停止',
    'select_platform': '選擇機器人平台',
    'configure_bot': '配置機器人',
    'confirm_add': '確認添加',
    'loading': '加載中...',
    'no_bots': '暫無機器人，點擊右上角添加',
    'admin': '管理員',
    'user': '普通用戶',
    'menu_group_main': '主要功能',
    'menu_group_system': '系統管理',
    'no_bots_desc': '您還沒有部署任何機器人，點擊右上角按鈕開始您的第一個 Bot 部署。',
    'start_now': '立即開始',
    'messages': '消息數',
    'group_chats': '群聊',
    'friends': '好友',
    'currently_selected': '當前選中',
    'set_as_current': '設為當前',
    'deploy_new_bot': '部署新機器人',
    'select_and_configure': '選擇平台並配置參數',
    'docker_image': 'Docker 鏡像',
    'deploying': '正在部署...',
    'deploy_now': '立即部署',
    'realtime_logs': '實時運行日誌',
    'syncing_live': '實時同步中...',
    'system_logs': '系統日誌',
    'centralized_log_mgmt': '中心化日誌管理系統',
    'auto_refresh_on': '自動刷新: 開啟',
    'auto_refresh_off': '自動刷新: 關閉',
    'export': '導出',
    'search_logs': '搜索日誌...',
    'all_sources': '所有來源',
    'all_levels': '所有級別',
    'entries_found': '條記錄',
    'fetching_logs': '實時獲取日誌...',
    'system': '系統',
    'confirm_clear_logs': '確定要清空所有系統日誌嗎？'
  },
  'en-US': {
    'dashboard': 'Dashboard',
    'bots': 'Bot Matrix',
    'nexus': 'Central Nexus',
    'workers': 'Workers',
    'contacts': 'Contacts',
    'tasks': 'Tasks',
    'fission': 'Fission',
    'docker': 'Docker',
    'routing': 'Routing',
    'users': 'Users',
    'logs': 'Log Center',
    'settings': 'Settings',
    'manual': 'Manual',
    'main_menu': 'Main Features',
    'automation_menu': 'Automation',
    'infrastructure_menu': 'Infrastructure',
    'system_menu': 'System',
    'workers_desc': 'Manage distributed worker nodes',
    'contacts_desc': 'View and manage bot contacts',
    'nexus_desc': 'Monitor core connections and relay status',
    'tasks_desc': 'Configure and monitor automated tasks',
    'fission_desc': 'Manage growth and social fission tasks',
    'docker_desc': 'Monitor and manage Docker containers',
    'routing_desc': 'Define global message routing rules',
    'users_desc': 'Manage access permissions and users',
    'manual_desc': 'View user manual and API documentation',
    'coming_soon': 'Coming Soon',
    'feature_under_development': 'This feature is undergoing modernization and will be available soon.',
    'system_uptime': 'System Uptime',
    'current_time': 'Current Time',
    'neural_link_active': 'Neural Link Active',
    'switch_lang': 'Switch Language',
    'switch_theme': 'Switch Theme',
    'logout': 'Logout',
    'refresh': 'Refresh',
    'clear': 'Clear',
    'save': 'Save',
    'cancel': 'Cancel',
    'status': 'Status',
    'actions': 'Actions',
    'theme_light': 'Light Mode',
    'theme_dark': 'Dark Mode',
    'theme_matrix': 'Matrix',
    'style_classic': 'Classic',
    'style_matrix': 'Matrix',
    'style_xp': 'Classic XP',
    'style_ios': 'iOS Glass',
    'style_kawaii': 'Kawaii Pink',
    'mode_light': 'Day Mode',
    'lang_zh_cn': 'Simplified Chinese',
    'lang_zh_tw': 'Traditional Chinese',
    'lang_en_us': 'English',
    'lang_ja_jp': 'Japanese',
    'auto_scroll': 'Auto Scroll',
    'log_level': 'Level',
    'source': 'Source',
    'message': 'Message',
    'time': 'Time',
    'no_logs': 'No logs available',
    'total_bots': 'Online Bots',
    'active_bots': 'Active Bots',
    'total_messages': 'Today\'s Messages',
    'system_load': 'System Load',
    'recent_logs': 'Recent Logs',
    'view_all': 'View All',
    'sidebar_dashboard': 'Dashboard',
    'sidebar_bots': 'Bot Matrix',
    'sidebar_monitor': 'Monitoring',
    'sidebar_docker': 'Docker Management',
    'sidebar_routing': 'Routing',
    'sidebar_logs': 'Log Center',
    'sidebar_users': 'User Management',
    'sidebar_settings': 'Settings',
    'sidebar_visualization': 'Neural Network',
    'status_live': 'LIVE',
    'status_loading': 'LOADING',
    'active_workers': 'Active Nodes',
    'messages_today': 'Today\'s Messages',
    'unit_nodes': 'NODES',
    'unit_active': 'ACTIVE',
    'unit_msg': 'Msg',
    'unit_time': 'Live',
    'cpu_usage': 'CPU Usage',
    'memory_usage': 'Memory Usage',
    'throughput': 'Throughput',
    'active_groups': 'Active Groups',
    'dragon_king': 'Dragon King',
    'monitor_detail': 'Monitor Detail',
    'network_traffic': 'Network Traffic',
    'process_monitor': 'Process Monitor',
    'disk_status': 'Disk Status',
    'group_rank': 'Group Rank',
    'speaker_rank': 'Speaker Rank',
    'bot_management': 'Bot Management',
    'add_bot': 'Add Bot',
    'bot_id': 'Bot ID',
    'view_logs': 'View Logs',
    'delete': 'Delete',
    'start': 'Start',
    'stop': 'Stop',
    'select_platform': 'Select Platform',
    'configure_bot': 'Configure Bot',
    'confirm_add': 'Confirm Add',
    'loading': 'Loading...',
    'no_bots': 'No bots found, click top right to add',
    'admin': 'Admin',
    'user': 'User',
    'menu_group_main': 'Main Features',
    'menu_group_system': 'System Management',
    'no_bots_desc': 'You haven\'t deployed any bots yet. Click the button in the top right to start your first deployment.',
    'start_now': 'Start Now',
    'messages': 'Messages',
    'group_chats': 'Groups',
    'friends': 'Friends',
    'currently_selected': 'Selected',
    'set_as_current': 'Set Current',
    'deploy_new_bot': 'Deploy New Bot',
    'select_and_configure': 'Select platform and configure parameters',
    'docker_image': 'Docker Image',
    'deploying': 'Deploying...',
    'deploy_now': 'Deploy Now',
    'realtime_logs': 'Real-time Logs',
    'syncing_live': 'Syncing live...',
    'system_logs': 'System Logs',
    'centralized_log_mgmt': 'Centralized log management system',
    'auto_refresh_on': 'Auto Refresh: ON',
    'auto_refresh_off': 'Auto Refresh: OFF',
    'export': 'Export',
    'search_logs': 'Search logs...',
    'all_sources': 'All Sources',
    'all_levels': 'All Levels',
    'entries_found': 'entries found',
    'fetching_logs': 'Fetching logs...',
    'system': 'System',
    'confirm_clear_logs': 'Are you sure you want to clear all system logs?'
  },
  'ja-JP': {
    'dashboard': '運行ステータス',
    'bots': 'ボットマトリックス',
    'nexus': 'セントラルネクサス',
    'workers': 'ワーカーノード',
    'contacts': '連絡先管理',
    'tasks': 'タスク管理',
    'fission': '拡散成長',
    'docker': 'コンテナ管理',
    'routing': 'ルート制御',
    'users': 'ユーザー権限',
    'manual': 'ユーザーマニュアル',
    'logs': 'ログセンター',
    'settings': 'システム設定',
    'main_menu': '主な機能',
    'automation_menu': '自動化',
    'infrastructure_menu': 'インフラストラクチャ',
    'system_menu': 'システム管理',
    'workers_desc': '各地に分散したワーカーノードを管理します',
    'contacts_desc': 'すべてのボットのフレンドとグループを表示・管理します',
    'nexus_desc': 'コア接続とリレー状態を監視します',
    'tasks_desc': '各種自動化タスクを設定・監視します',
    'fission_desc': 'ソーシャル拡散と成長タスクを管理します',
    'docker_desc': 'Docker コンテナの状態を監視・管理します',
    'routing_desc': 'グローバルメッセージルーティングルールを定義します',
    'users_desc': 'システムアクセス権限とユーザーを管理します',
    'manual_desc': 'ユーザーマニュアルと API ドキュメントを表示します',
    'coming_soon': '近日公開',
    'feature_under_development': 'この機能は現在アップグレード中で、間もなく公開されます。',
    'system_uptime': 'システム稼働時間',
    'current_time': '現在時刻',
    'neural_link_active': 'ニューラルリンク確立',
    'switch_lang': '言語切替',
    'switch_theme': 'テーマ切替',
    'logout': 'ログアウト',
    'refresh': '更新',
    'clear': 'クリア',
    'save': '保存',
    'cancel': 'キャンセル',
    'status': 'ステータス',
    'actions': '操作',
    'theme_light': 'ライトモード',
    'theme_dark': 'ダークモード',
    'theme_matrix': 'マトリックス',
    'style_classic': 'クラシック',
    'style_matrix': 'マトリックス',
    'style_xp': 'XP クラシック',
    'style_ios': 'iOS ガラス',
    'style_kawaii': 'カワイイピンク',
    'lang_zh_cn': '简体中文',
    'lang_zh_tw': '繁體中文',
    'lang_en_us': 'English',
    'lang_ja_jp': '日本語',
    'auto_scroll': '自動スクロール',
    'log_level': 'ログレベル',
    'source': 'ソース',
    'message': 'メッセージ',
    'time': '時間',
    'no_logs': 'ログデータなし',
    'total_bots': 'オンラインボット',
    'active_bots': 'アクティブボット',
    'total_messages': '今日のメッセージ',
    'system_load': 'システム負荷',
    'recent_logs': '最近のログ',
    'view_all': 'すべて表示',
    'sidebar_dashboard': 'ダッシュボード',
    'sidebar_bots': 'ボット管理',
    'sidebar_monitor': 'システム監視',
    'sidebar_docker': 'Docker管理',
    'sidebar_routing': 'ルート管理',
    'sidebar_logs': 'ログセンター',
    'sidebar_users': 'ユーザー管理',
    'sidebar_settings': 'システム設定',
    'sidebar_visualization': 'ニューラルネットワーク',
    'status_live': 'ライブ',
    'status_loading': '読み込み中',
    'active_workers': 'アクティブノード',
    'messages_today': '今日のメッセージ',
    'unit_nodes': 'ノード',
    'unit_active': 'アクティブ',
    'unit_msg': 'メッセージ',
    'unit_time': 'リアルタイム',
    'cpu_usage': 'CPU使用率',
    'memory_usage': 'メモリ使用量',
    'throughput': 'スループット',
    'active_groups': 'アクティブなグループ',
    'dragon_king': '今日の龍王',
    'monitor_detail': 'モニタリング詳細',
    'network_traffic': 'ネットワークトラフィック',
    'process_monitor': 'プロセス監視',
    'disk_status': 'ディスク状態',
    'group_rank': 'グループランキング',
    'speaker_rank': '発言ランキング',
    'bot_management': 'ボット管理',
    'add_bot': 'ボットを追加',
    'bot_id': 'ボット ID',
    'view_logs': 'ログを表示',
    'delete': '削除',
    'start': '起動',
    'stop': '停止',
    'select_platform': 'プラットフォームを選択',
    'configure_bot': 'ボットを設定',
    'confirm_add': '追加を確認',
    'loading': '読み込み中...',
    'no_bots': 'ボットが見つかりません',
    'admin': '管理者',
    'user': 'ユーザー',
    'menu_group_main': '主な機能',
    'menu_group_system': 'システム管理',
    'no_bots_desc': 'ボットがまだデプロイされていません。右上のボタンをクリックして開始してください。',
    'start_now': '今すぐ開始',
    'messages': 'メッセージ',
    'group_chats': 'グループ',
    'friends': 'フレンド',
    'currently_selected': '選択中',
    'set_as_current': '現在に設定',
    'deploy_new_bot': '新しいボットをデプロイ',
    'select_and_configure': 'プラットフォームを選択し、パラメータを設定します',
    'docker_image': 'Docker イメージ',
    'deploying': 'デプロイ中...',
    'deploy_now': '今すぐデプロイ',
    'realtime_logs': 'リアルタイムログ',
    'syncing_live': '同期中...',
    'system_logs': 'システムログ',
    'centralized_log_mgmt': '集中ログ管理システム',
    'auto_refresh_on': '自動更新: オン',
    'auto_refresh_off': '自動更新: オフ',
    'export': 'エクスポート',
    'search_logs': 'ログを検索...',
    'all_sources': 'すべてのソース',
    'all_levels': 'すべてのレベル',
    'entries_found': '件見つかりました',
    'fetching_logs': 'ログを取得中...',
    'system': 'システム',
    'confirm_clear_logs': 'すべてのシステムログを消去してもよろしいですか？'
  }
};

export const t = (lang: Language, key: string): string => {
  const text = translations[lang]?.[key];
  
  if (text) return text;

  // 这里的逻辑可以扩展为 AI 自动翻译原型
  // 如果找不到 Key，可以触发一个后台翻译任务
  // 暂时禁用 triggerTranslation 以避免 404 错误
  /*
  if (typeof window !== 'undefined' && !window.translatedKeys?.[lang]?.[key]) {
    triggerTranslation(lang, key);
  }
  */

  return key;
};

// 翻译逻辑 (目前使用 Azure)
const triggerTranslation = async (lang: Language, key: string) => {
  if (!window.translatedKeys) window.translatedKeys = {};
  if (!window.translatedKeys[lang]) window.translatedKeys[lang] = {};
  
  // 标记为正在翻译
  window.translatedKeys[lang][key] = '...';

  try {
    // 调用基础翻译接口
    const response = await translateApi.translate({
      text: key,
      target_lang: lang
    });

    const result = response.data;

    if (result.success && result.data?.translated_text) {
      window.translatedKeys[lang][key] = `[Azure] ${result.data.translated_text}`;
    } else {
      // 回退逻辑：处理 Key 名
      const mockTranslation = key.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
      window.translatedKeys[lang][key] = `[Azure] ${mockTranslation}`;
    }
    
    // 触发更新
    window.dispatchEvent(new CustomEvent('ai-translation-updated', { detail: { lang, key } }));
    
  } catch (error) {
    // 回退逻辑
    const mockTranslation = key.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
    window.translatedKeys[lang][key] = `[Azure] ${mockTranslation}`;
    window.dispatchEvent(new CustomEvent('ai-translation-updated', { detail: { lang, key } }));
  }
};

declare global {
  interface Window {
    translatedKeys: any;
  }
}
