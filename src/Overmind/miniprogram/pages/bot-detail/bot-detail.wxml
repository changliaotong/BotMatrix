<!-- 机器人详情页面 -->
<view class="container">
  <!-- 机器人基本信息卡片 -->
  <view class="bot-info-card" wx:if="{{bot}}">
    <view class="bot-header">
      <view class="bot-basic-info">
        <view class="bot-name-wrapper">
          <text class="bot-name">{{bot.name}}</text>
          <text class="bot-id">#{{bot.id}}</text>
        </view>
        <view class="bot-platform">
          <text class="platform-badge platform-{{bot.platform}}">{{bot.platformText}}</text>
        </view>
      </view>
      
      <view class="bot-status-info">
        <view class="status-indicator-wrapper">
          <view 
            class="status-indicator" 
            style="background-color: {{bot.statusColor}}"
          ></view>
          <text class="status-text" style="color: {{bot.statusColor}}">{{bot.statusText}}</text>
        </view>
        <text class="uptime-text">{{bot.uptimeText}}</text>
      </view>
    </view>

    <view class="bot-stats">
      <view class="stat-item">
        <text class="stat-value">{{bot.groupCount || 0}}</text>
        <text class="stat-label">管理群组</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{bot.messageCount || 0}}</text>
        <text class="stat-label">处理消息</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{bot.lastSeenText}}</text>
        <text class="stat-label">最后在线</text>
      </view>
    </view>

    <view class="bot-actions">
      <button 
        class="action-btn {{bot.status === 'online' ? 'btn-stop' : 'btn-start'}}" 
        bindtap="toggleBotStatus"
      >
        {{bot.status === 'online' ? '停止机器人' : '启动机器人'}}
      </button>
      <button class="action-btn btn-restart" bindtap="restartBot">重启机器人</button>
      <button class="action-btn btn-delete" bindtap="deleteBot">删除机器人</button>
    </view>
  </view>

  <!-- 标签页导航 -->
  <view class="tab-nav">
    <view 
      class="tab-item {{activeTab === 'info' ? 'active' : ''}}" 
      data-tab="info"
      bindtap="onTabChange"
    >
      <text class="tab-text">基本信息</text>
    </view>
    <view 
      class="tab-item {{activeTab === 'logs' ? 'active' : ''}}" 
      data-tab="logs"
      bindtap="onTabChange"
    >
      <text class="tab-text">运行日志</text>
    </view>
    <view 
      class="tab-item {{activeTab === 'config' ? 'active' : ''}}" 
      data-tab="config"
      bindtap="onTabChange"
    >
      <text class="tab-text">配置管理</text>
    </view>
  </view>

  <!-- 基本信息标签页 -->
  <view class="tab-content" wx:if="{{activeTab === 'info' && bot}}">
    <view class="info-section">
      <view class="section-title">连接信息</view>
      <view class="info-item">
        <text class="info-label">平台:</text>
        <text class="info-value">{{bot.platformText}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">账号:</text>
        <text class="info-value">{{bot.account || '未设置'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">状态:</text>
        <text class="info-value" style="color: {{bot.statusColor}}">{{bot.statusText}}</text>
      </view>
    </view>

    <view class="info-section">
      <view class="section-title">统计信息</view>
      <view class="info-item">
        <text class="info-label">创建时间:</text>
        <text class="info-value">{{bot.createdAt ? new Date(bot.createdAt).toLocaleString('zh-CN') : '未知'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">运行时长:</text>
        <text class="info-value">{{bot.uptimeText}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">最后在线:</text>
        <text class="info-value">{{bot.lastSeenText}}</text>
      </view>
    </view>

    <view class="info-section">
      <view class="section-title">性能指标</view>
      <view class="info-item">
        <text class="info-label">CPU使用率:</text>
        <text class="info-value">{{bot.cpuUsage || 0}}%</text>
      </view>
      <view class="info-item">
        <text class="info-label">内存使用:</text>
        <text class="info-value">{{bot.memoryUsage || 0}}MB</text>
      </view>
      <view class="info-item">
        <text class="info-label">消息处理速度:</text>
        <text class="info-value">{{bot.messageRate || 0}}/分钟</text>
      </view>
    </view>
  </view>

  <!-- 运行日志标签页 -->
  <view class="tab-content" wx:if="{{activeTab === 'logs'}}">
    <view class="logs-container" wx:if="{{logs.length > 0}}">
      <view class="log-item" wx:for="{{logs}}" wx:key="timestamp">
        <view class="log-header">
          <text class="log-time">{{formatLogTime(item.timestamp)}}</text>
          <text 
            class="log-level level-{{item.level}}" 
            style="color: {{getLogLevelColor(item.level)}}"
          >{{item.level.toUpperCase()}}</text>
        </view>
        <text class="log-message">{{item.message}}</text>
        <text class="log-source" wx:if="{{item.source}}">来源: {{item.source}}</text>
      </view>
    </view>
    
    <view class="empty-logs" wx:if="{{logs.length === 0}}">
      <text class="empty-text">暂无日志记录</text>
    </view>
  </view>

  <!-- 配置管理标签页 -->
  <view class="tab-content" wx:if="{{activeTab === 'config'}}">
    <view class="config-container" wx:if="{{!editConfig}}">
      <view class="config-section">
        <view class="section-title">基础设置</view>
        <view class="config-item">
          <text class="config-label">自动回复</text>
          <switch checked="{{config.autoReply}}" disabled="true" />
        </view>
        <view class="config-item">
          <text class="config-label">群组管理</text>
          <switch checked="{{config.groupManage}}" disabled="true" />
        </view>
      </view>

      <view class="config-section">
        <view class="section-title">欢迎消息</view>
        <view class="config-textarea">
          <text class="config-text">{{config.welcomeMessage || '未设置'}}</text>
        </view>
      </view>

      <view class="config-actions">
        <button class="config-btn btn-edit" bindtap="startConfigEdit">编辑配置</button>
      </view>
    </view>

    <!-- 编辑模式 -->
    <view class="config-container" wx:if="{{editConfig}}">
      <view class="config-section">
        <view class="section-title">基础设置</view>
        <view class="config-item">
          <text class="config-label">自动回复</text>
          <switch 
            checked="{{editConfig.autoReply}}" 
            data-field="autoReply"
            bindchange="onConfigSwitch"
          />
        </view>
        <view class="config-item">
          <text class="config-label">群组管理</text>
          <switch 
            checked="{{editConfig.groupManage}}" 
            data-field="groupManage"
            bindchange="onConfigSwitch"
          />
        </view>
      </view>

      <view class="config-section">
        <view class="section-title">欢迎消息</view>
        <textarea 
          class="config-textarea-input" 
          placeholder="请输入欢迎消息"
          value="{{editConfig.welcomeMessage}}"
          data-field="welcomeMessage"
          bindinput="onConfigInput"
          auto-height="true"
          maxlength="500"
        />
      </view>

      <view class="config-actions">
        <button class="config-btn btn-save" bindtap="saveConfig">保存配置</button>
        <button class="config-btn btn-cancel" bindtap="cancelConfigEdit">取消</button>
      </view>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">正在加载机器人详情...</text>
  </view>

  <!-- 错误状态 -->
  <view class="error-state" wx:if="{{loadError}}">
    <view class="error-icon">⚠️</view>
    <text class="error-title">加载失败</text>
    <text class="error-desc">{{loadError}}</text>
    <button class="retry-btn" bindtap="loadBotDetail">重新加载</button>
  </view>
</view>