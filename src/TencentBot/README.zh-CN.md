# TencentBot ğŸ§

ä¸€ä¸ªåŸºäºGoè¯­è¨€å¼€å‘çš„å®˜æ–¹QQé¢‘é“/ç¾¤æœºå™¨äººå®ç°ï¼Œç”¨äº[BotMatrix](../README.md)ï¼Œä½¿ç”¨å®˜æ–¹`botgo` SDKã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

*   **å®˜æ–¹API**: å®Œå…¨å…¼å®¹è…¾è®¯QQé¢‘é“å’Œç¾¤èŠçš„å®˜æ–¹APIè¦æ±‚ã€‚
*   **OneBot 11å…¼å®¹**: å°†å®˜æ–¹äº‹ä»¶æ¡¥æ¥åˆ°OneBotæ ‡å‡†æ ¼å¼ã€‚
*   **å…¨é¢çš„äº‹ä»¶å¤„ç†**: æ”¯æŒ8ç§ç±»å‹çš„äº‹ä»¶ï¼ŒåŒ…æ‹¬æ¶ˆæ¯ã€é¢‘é“äº‹ä»¶ã€æˆå‘˜äº‹ä»¶ç­‰ã€‚
*   **æ¶ˆæ¯ç®¡ç†**:
    *   æ”¯æŒå‘QQé¢‘é“ã€ç¾¤èŠå’Œç§èŠå‘é€æ¶ˆæ¯
    *   æ”¯æŒå¤šç§åª’ä½“ç±»å‹ï¼šæ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘å’Œæ–‡ä»¶
    *   **é˜…åå³ç„š**: æ”¯æŒä½¿ç”¨`RetractMessage` APIæ’¤å›æ¶ˆæ¯
*   **é¢‘é“ç®¡ç†**:
    *   åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤é¢‘é“
    *   è·å–é¢‘é“åˆ—è¡¨å’Œé¢‘é“è¯¦æƒ…
*   **æˆå‘˜ç®¡ç†**:
    *   è·å–é¢‘é“æˆå‘˜åˆ—è¡¨å’Œä¸ªäººèµ„æ–™
    *   ç®¡ç†æˆå‘˜è§’è‰²
*   **WebSocketé€šä¿¡**: ä¸BotNexuså®æ—¶åŒå‘é€šä¿¡ã€‚
*   **ä¿æ´»æœºåˆ¶**: ä¿æŒä¸è…¾è®¯APIçš„æŒä¹…è¿æ¥ã€‚
*   **Dockeræ”¯æŒ**: ä½¿ç”¨Dockerå®¹å™¨è½»æ¾éƒ¨ç½²ã€‚

### ğŸ”¥ é˜…åå³ç„šï¼ˆæ¶ˆæ¯æ’¤å›ï¼‰

*   **æœºåˆ¶**: ä½¿ç”¨`RetractMessage` APIå®ç°ã€‚
*   **è¦æ±‚**:
    *   å¯¹äºç¾¤æ¶ˆæ¯ï¼Œéœ€è¦`group_id`ä¸Šä¸‹æ–‡ï¼ˆé€šè¿‡IDæ˜ å°„æˆ–`channel_id`å†…éƒ¨å¤„ç†ï¼‰ã€‚
    *   ä¸ºæ’¤å›æ“ä½œè¿”å›æœ‰æ•ˆçš„`message_id`ã€‚

### ğŸ“‹ æ”¯æŒçš„OneBot API

#### æ¶ˆæ¯æ“ä½œ
- `send_msg`: å‘é¢‘é“ã€ç¾¤èŠæˆ–ç§èŠå‘é€æ¶ˆæ¯
- `send_group_msg`: å‘é€ç¾¤æ¶ˆæ¯
- `send_private_msg`: å‘é€ç§èŠæ¶ˆæ¯
- `send_guild_channel_msg`: å‘é€é¢‘é“æ¶ˆæ¯
- `delete_msg`: æ’¤å›æ¶ˆæ¯
- `get_message`: è·å–æ¶ˆæ¯è¯¦æƒ…

#### é¢‘é“æ“ä½œ
- `create_guild_channel`: åˆ›å»ºæ–°é¢‘é“
- `update_guild_channel`: æ›´æ–°é¢‘é“ä¿¡æ¯
- `delete_guild_channel`: åˆ é™¤é¢‘é“
- `get_guild_channel_list`: è·å–é¢‘é“åˆ—è¡¨

#### é¢‘é“ç®¡ç†æ“ä½œ
- `get_guild_list`: è·å–é¢‘é“åˆ—è¡¨
- `get_guild_meta`: è·å–é¢‘é“è¯¦æƒ…

#### æˆå‘˜æ“ä½œ
- `get_guild_member_list`: è·å–é¢‘é“æˆå‘˜åˆ—è¡¨
- `get_guild_member_profile`: è·å–é¢‘é“æˆå‘˜èµ„æ–™
- `get_guild_member_info`: è·å–é¢‘é“æˆå‘˜ä¿¡æ¯

#### è§’è‰²æ“ä½œ
- `get_guild_roles`: è·å–é¢‘é“è§’è‰²åˆ—è¡¨
- `create_guild_role`: åˆ›å»ºæ–°è§’è‰²
- `update_guild_role`: æ›´æ–°è§’è‰²ä¿¡æ¯
- `delete_guild_role`: åˆ é™¤è§’è‰²

#### ç³»ç»Ÿæ“ä½œ
- `get_login_info`: è·å–æœºå™¨äººç™»å½•ä¿¡æ¯
- `get_group_list`: è·å–ç¾¤åˆ—è¡¨ï¼ˆä»é¢‘é“æ˜ å°„ï¼‰
- `get_version_info`: è·å–ç‰ˆæœ¬ä¿¡æ¯
- `get_logs`: è·å–æœºå™¨äººæ—¥å¿—

### ğŸ¯ æ”¯æŒçš„äº‹ä»¶ç±»å‹

- é¢‘é“@æ¶ˆæ¯
- ç§ä¿¡æ¶ˆæ¯
- é¢‘é“äº‹ä»¶
- é¢‘é“æˆå‘˜äº‹ä»¶
- å­é¢‘é“äº‹ä»¶
- æ¶ˆæ¯ååº”äº‹ä»¶
- QQç¾¤@æ¶ˆæ¯
- QQç§èŠæ¶ˆæ¯

## ğŸ›  é…ç½®

ä»ç¤ºä¾‹åˆ›å»º`config.json`æ–‡ä»¶ï¼š

```json
{
    "app_id": 123456789,
    "token": "YOUR_BOT_TOKEN",
    "secret": "YOUR_APP_SECRET",
    "sandbox": true,
    "self_id": "",
    "log_port": 3133,
    "file_host": "https://www.sz84.com",
    "media_route": "/bot-files/",
    "websocket_addrs": [
        {
            "name": "Default",
            "url": "ws://bot-nexus:3001"
        }
    ]
}
```

### é…ç½®é€‰é¡¹

| å­—æ®µå           | ç±»å‹      | æè¿°                                                                 |
|------------------|-----------|----------------------------------------------------------------------|
| `app_id`         | uint64    | æ‚¨çš„è…¾è®¯æœºå™¨äººAppID                                                   |
| `token`          | string    | æ‚¨çš„è…¾è®¯æœºå™¨äººToken                                                   |
| `secret`         | string    | æ‚¨çš„è…¾è®¯æœºå™¨äººSecret                                                   |
| `sandbox`        | bool      | æ˜¯å¦ä½¿ç”¨æ²™ç®±ç¯å¢ƒï¼ˆç”¨äºæµ‹è¯•ï¼‰                                          |
| `self_id`        | string    | å¯é€‰ï¼šæ‰‹åŠ¨è®¾ç½®æœºå™¨äººID                                                |
| `log_port`       | int       | HTTPæ—¥å¿—æŸ¥çœ‹å™¨çš„ç«¯å£                                                 |
| `file_host`      | string    | ç”¨äºæä¾›æ–‡ä»¶çš„å…¬å…±åŸºç¡€URLï¼ˆä¾‹å¦‚ï¼šhttp://1.2.3.4:8080ï¼‰               |
| `media_route`    | string    | åª’ä½“æ–‡ä»¶çš„å†…éƒ¨è·¯ç”±è·¯å¾„                                               |
| `websocket_addrs`| array     | è¦è¿æ¥çš„WebSocketåœ°å€åˆ—è¡¨                                             |
| `nexus_addr`     | string    | ç”¨äºå‘åå…¼å®¹çš„BotNexusåœ°å€                                           |

## ğŸš€ éƒ¨ç½²

### é€‰é¡¹1: æœ¬åœ°å¼€å‘

```bash
cd src/TencentBot
go build -o TencentBot.exe main.go
./TencentBot.exe
```

### é€‰é¡¹2: Dockeréƒ¨ç½²

#### æ„å»ºDockeré•œåƒ
```bash
docker build -t tencent-bot .
```

#### è¿è¡ŒDockerå®¹å™¨
```bash
docker run -d --name tencent-bot \
  -v $(pwd)/config.json:/app/config.json \
  --network botmatrix \
  tencent-bot
```

### é€‰é¡¹3: è‡ªåŠ¨åŒ–éƒ¨ç½²

ä½¿ç”¨deploy.pyè„šæœ¬è‡ªåŠ¨éƒ¨ç½²åˆ°UbuntuæœåŠ¡å™¨ï¼š

```bash
python deploy.py --target tencent-bot --ip 192.168.0.167 --user derlin
```

## ğŸ“¦ Dockerfile

é¡¹ç›®åŒ…å«ç”¨äºå®¹å™¨åŒ–éƒ¨ç½²çš„Dockerfileï¼š

```dockerfile
FROM golang:1.21-alpine

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY . .

RUN go build -o TencentBot main.go

CMD ["./TencentBot"]
```

## ğŸ“ æ—¥å¿—

æœºå™¨äººæä¾›è¯¦ç»†çš„æ—¥å¿—è®°å½•ï¼š
- ä¸BotNexusçš„è¿æ¥çŠ¶æ€
- æ¶ˆæ¯å¤„ç†äº‹ä»¶
- APIè¯·æ±‚/å“åº”è¯¦æƒ…
- é”™è¯¯å¤„ç†å’Œæ¢å¤

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç¼–è¯‘é”™è¯¯**
   - ç¡®ä¿å®‰è£…äº†Go 1.21æˆ–æ›´é«˜ç‰ˆæœ¬
   - è¿è¡Œ`go mod tidy`ä»¥è§£å†³ä¾èµ–å…³ç³»

2. **è¿æ¥å¤±è´¥**
   - æ£€æŸ¥BotNexusæ˜¯å¦æ­£åœ¨è¿è¡Œ
   - éªŒè¯config.jsonä¸­çš„`nexus_addr`é…ç½®
   - ç¡®ä¿é˜²ç«å¢™å…è®¸WebSocketè¿æ¥

3. **APIé”™è¯¯**
   - éªŒè¯`app_id`ã€`token`å’Œ`secret`æ˜¯å¦æ­£ç¡®
   - æ£€æŸ¥æœºå™¨äººæ˜¯å¦å·²è¢«è…¾è®¯å®¡æ ¸é€šè¿‡

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤é—®é¢˜å’Œæ‹‰å–è¯·æ±‚ã€‚